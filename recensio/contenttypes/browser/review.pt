<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      lang="en"
      metal:use-macro="here/main_template/macros/master"
      i18n:domain="plone">

  <metal:js fill-slot="javascript_head_slot">
    <script type="text/javascript" tal:attributes="src string:${context/absolute_url}/++resource++pageturner.resources/swfobject.js"></script>
    <script type="text/javascript">
      jq(document).ready(function(){
      if(window.addEventListener)
      window.addEventListener('DOMMouseScroll', handleWheel, false);
      window.onmousewheel = document.onmousewheel = handleWheel;
	  
      if (window.attachEvent)
      window.attachEvent("onmousewheel", handleWheel);
	  
      function handleWheel(event){
      try{
      if(!window.document.FlexPaperViewer.hasFocus()){return true;}
      window.document.FlexPaperViewer.setViewerFocus(true);
      window.document.FlexPaperViewer.focus();
	  
      if(navigator.appName == "Netscape"){
      if (event.detail)
      delta = 0;
      if (event.preventDefault){
      event.preventDefault();
      event.returnValue = false;
      }
      }
      return false;
      }catch(err){return true;}
      }
      });
    </script>
    <script type="text/javascript" tal:content="structure view/javascript"></script>
  </metal:js>
  <metal:css fill-slot="style_slot">
    <style type="text/css" media="screen">
      #pageturner { display:none; }
    </style>
  </metal:css>

  <body>
    <div metal:fill-slot="content-core">

      <div id="review">
        <h2 tal:content="view/get_review_title"></h2>
        <p tal:content="context/getReview"></p>
      </div>
      <div id="review-reference">
        <tal:pdf-viewer condition="view/has_pdf">
          <div id="pageturner">
            tal:condition="python: view.installed and view.is_pdf and view.view.settings.successfully_converted">
            <p> To view this page ensure that Adobe Flash Player version 9.0.124 or greater is installed.</p> 
          </div>

        </tal:pdf-viewer>
      </div>
      <div id="review-metadata"
           tal:define="metadata view/get_metadata">
        <dl tal:condition="python:context.meta_type == 'ReviewJournal'">
          <dt>Publication Title</dt>
          <dd tal:content="context/get_publication_title"></dd>
          <dt>Volume Title</dt>
          <dd tal:content="context/get_volume_title"></dd>
        </dl>
        <dl tal:repeat="field python:metadata.keys()">
            <dt tal:content="python:metadata[field]"></dt>
            <dd><tal:widget metal:use-macro="python:context.widget(field)" /></dd>
        </dl>
      </div>

    </div>
  </body>
</html>
